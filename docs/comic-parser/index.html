<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>@ridi/comic-parser</title>
	<meta name="description" content="Documentation for @ridi/comic-parser">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">@ridi/comic-parser</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
				<li>
					<a href="globals.html">Globals</a>
				</li>
			</ul>
			<h1>@ridi/comic-parser</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#ridicomic-parser" id="ridicomic-parser" style="color: inherit; text-decoration: none;">
					<h1>@ridi/comic-parser</h1>
				</a>
				<blockquote>
					<p>Common comic data parser for Ridibooks services</p>
				</blockquote>
				<p><a href="https://badge.fury.io/js/%40ridi%2Fcomic-parser"><img src="https://badge.fury.io/js/%40ridi%2Fcomic-parser.svg" alt="NPM version"></a>
					<a href="https://travis-ci.org/ridi/content-parser"><img src="https://travis-ci.org/ridi/content-parser.svg?branch=master" alt="Build Status"></a>
					<a href="https://codecov.io/gh/ridi/content-parser"><img src="https://codecov.io/gh/ridi/content-parser/branch/master/graph/badge.svg" alt="codecov"></a>
				<a href="https://npm.im/%40ridi%2Fcomic-parser"><img src="https://img.shields.io/npm/dt/%40ridi%2Fcomic-parser.svg" alt="NPM total downloads"></a></p>
				<a href="#features" id="features" style="color: inherit; text-decoration: none;">
					<h2>Features</h2>
				</a>
				<ul>
					<li><input checked="" disabled="" type="checkbox"> Single structure parsing</li>
					<li><input disabled="" type="checkbox"> Nested structure parsing</li>
					<li><input checked="" disabled="" type="checkbox"> Unzip zip file when parsing with options</li>
					<li><input checked="" disabled="" type="checkbox"> Read files<ul>
							<li><input checked="" disabled="" type="checkbox"> Read image in base64 encoding</li>
						</ul>
					</li>
					<li><input checked="" disabled="" type="checkbox"> Encrypt and decrypt function when parsing or reading or unzipping</li>
					<li><input disabled="" type="checkbox"> Debug mode</li>
					<li><input disabled="" type="checkbox"> Environment<ul>
							<li><input checked="" disabled="" type="checkbox"> Node</li>
							<li><input disabled="" type="checkbox"> CLI</li>
							<li><input disabled="" type="checkbox"> Browser</li>
						</ul>
					</li>
					<li><input disabled="" type="checkbox"> Online demo</li>
				</ul>
				<a href="#install" id="install" style="color: inherit; text-decoration: none;">
					<h2>Install</h2>
				</a>
				<pre><code class="language-bash">npm install @ridi/comic-parser</code></pre>
				<a href="#usage" id="usage" style="color: inherit; text-decoration: none;">
					<h2>Usage</h2>
				</a>
				<p>Basic:</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { ComicParser } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@ridi/comic-parser&#x27;</span>;
<span class="hljs-comment">// or const { ComicParser } = require(&#x27;@ridi/comic-parser&#x27;);</span>

<span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> ComicParser(<span class="hljs-string">&#x27;./foo/bar.zip&#x27;</span> or <span class="hljs-string">&#x27;./unzippedPath&#x27;</span>);
parser.parse(<span class="hljs-comment">/* { parseOptions } */</span>).then(<span class="hljs-function">(<span class="hljs-params">book</span>) =&gt;</span> {
  parser.readItems(items<span class="hljs-comment">/*, { readOptions } */</span>).then(<span class="hljs-function">(<span class="hljs-params">results</span>) =&gt;</span> {
    ...
  });
  ...
});</code></pre>
				<p>with <a href="https://github.com/ridi/content-parser/blob/master/src/cryptor/AesCryptor.js">AesCryptor</a>:</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { CryptoProvider, AesCryptor } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@ridi/comic-parser&#x27;</span>;
<span class="hljs-comment">// or const { CryptoProvider, AesCryptor } = require(&#x27;@ridi/comic-parser&#x27;);</span>

<span class="hljs-keyword">const</span> { Purpose } = CryptoProvider;
<span class="hljs-keyword">const</span> { Mode, Padding } = AesCryptor;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ContentCryptoProvider</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CryptoProvider</span> </span>{
  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">key</span>)</span> {
    <span class="hljs-built_in">super</span>();
    <span class="hljs-built_in">this</span>.cryptor = <span class="hljs-keyword">new</span> AesCryptor(Mode.ECB, { key });
  }

  <span class="hljs-function"><span class="hljs-title">getCryptor</span>(<span class="hljs-params">filePath, purpose</span>)</span> {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.cryptor;
  }

  <span class="hljs-comment">// If use as follows:</span>
  <span class="hljs-comment">// const provider = new ContentCryptoProvider(...);</span>
  <span class="hljs-comment">// const parser = new ComicParser(&#x27;encrypted.zip&#x27;, provider);</span>
  <span class="hljs-comment">// const book = await parser.parse({ unzipPath: ... });</span>
  <span class="hljs-comment">// const firstImage = await parser.readItem(book.items[0]);</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-comment">// It will be called as follows:</span>
  <span class="hljs-comment">// 1. run(data, &#x27;encrypted.zip&#x27;, Purpose.READ_IN_DIR)</span>
  <span class="hljs-comment">// 2. run(data, &#x27;0001.jpg&#x27;, Purpose.READ_IN_ZIP)</span>
  <span class="hljs-comment">// ...</span>
  <span class="hljs-comment">// 4. run(data, &#x27;0001.jpg&#x27;, Purpose.WRITE)</span>
  <span class="hljs-comment">// ...</span>
  <span class="hljs-comment">// 5. run(data, &#x27;0001.jpg&#x27;, Purpose.READ_IN_DIR)</span>
  <span class="hljs-comment">//</span>
  <span class="hljs-function"><span class="hljs-title">run</span>(<span class="hljs-params">data, filePath, purpose</span>)</span> {
    <span class="hljs-keyword">const</span> cryptor = <span class="hljs-built_in">this</span>.getCryptor(filePath, purpose);
    <span class="hljs-keyword">const</span> padding = Padding.AUTO;
    <span class="hljs-keyword">if</span> (purpose === Purpose.READ_IN_DIR) {
      <span class="hljs-keyword">return</span> cryptor.decrypt(data, { padding });
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (purpose === Purpose.WRITE) {
      <span class="hljs-keyword">return</span> cryptor.encrypt(data, { padding });
    }
    <span class="hljs-keyword">return</span> data;
  }
}

<span class="hljs-keyword">const</span> cryptoProvider = <span class="hljs-keyword">new</span> ContentCryptoProvider(key);
<span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> ComicParser(<span class="hljs-string">&#x27;./encrypted.zip&#x27;</span> or <span class="hljs-string">&#x27;./unzippedPath&#x27;</span>, cryptoProvider);</code></pre>
				<p>Log level setting:</p>
				<pre><code class="language-js"><span class="hljs-keyword">import</span> { LogLevel, ... } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@ridi/comic-parser&#x27;</span>;
<span class="hljs-keyword">const</span> parser = <span class="hljs-keyword">new</span> ComicParser(<span class="hljs-comment">/* path */</span>, <span class="hljs-comment">/* cryptoProvider */</span>, <span class="hljs-comment">/* logLevel */</span>)
<span class="hljs-comment">// or const parser = new ComicParser(/* path */, /* logLevel */)</span>
parser.logger.logLevel = LogLevel.VERBOSE; <span class="hljs-comment">// SILENT, ERROR, WARN(default), INFO, DEBUG, VERBOSE</span></code></pre>
				<a href="#api" id="api" style="color: inherit; text-decoration: none;">
					<h2>API</h2>
				</a>
				<a href="#parseparseoptions" id="parseparseoptions" style="color: inherit; text-decoration: none;">
					<h3>parse(parseOptions)</h3>
				</a>
				<p>Returns <code>Promise&lt;ComicBook&gt;</code> with:</p>
				<ul>
					<li><a href="#book">ComicBook</a>: Instance with image path, size, etc.</li>
				</ul>
				<p>Or throw exception.</p>
				<a href="#parseoptions-object" id="parseoptions-object" style="color: inherit; text-decoration: none;">
					<h4><a href="#parseOptions">parseOptions</a>: <code>?object</code></h4>
				</a>
				<hr>
				<a href="#readitemitem-readoptions" id="readitemitem-readoptions" style="color: inherit; text-decoration: none;">
					<h3>readItem(item, readOptions)</h3>
				</a>
				<p>Returns <code>string</code> or <code>Buffer</code> in <code>Promise</code> with:</p>
				<ul>
					<li><p>If <code>readOptions.base64</code> is <code>true</code>:</p>
						<ul>
							<li><code>string</code></li>
						</ul>
					</li>
					<li><p>Other:</p>
						<ul>
							<li><code>Buffer</code></li>
						</ul>
					</li>
				</ul>
				<p>or throw exception.</p>
				<a href="#item-item" id="item-item" style="color: inherit; text-decoration: none;">
					<h4>item: <a href="#item">Item</a></h4>
				</a>
				<a href="#readoptions-object" id="readoptions-object" style="color: inherit; text-decoration: none;">
					<h4><a href="#readOptions">readOptions</a>: <code>?object</code></h4>
				</a>
				<hr>
				<a href="#readitemsitems-readoptions" id="readitemsitems-readoptions" style="color: inherit; text-decoration: none;">
					<h3>readItems(items, readOptions)</h3>
				</a>
				<p>Returns <code>string[]</code> or <code>Buffer[]</code> in <code>Promise</code> with:</p>
				<ul>
					<li><p>If <code>readOptions.base64</code> is <code>true</code>:</p>
						<ul>
							<li><code>string</code></li>
						</ul>
					</li>
					<li><p>Other:</p>
						<ul>
							<li><code>Buffer</code></li>
						</ul>
					</li>
				</ul>
				<p>or throw exception.</p>
				<a href="#items-item" id="items-item" style="color: inherit; text-decoration: none;">
					<h4>items: <a href="#item">Item[]</a></h4>
				</a>
				<a href="#readoptions-object-1" id="readoptions-object-1" style="color: inherit; text-decoration: none;">
					<h4><a href="#readOptions">readOptions</a>: <code>?object</code></h4>
				</a>
				<hr>
				<a href="#unzipunzippath-overwrite" id="unzipunzippath-overwrite" style="color: inherit; text-decoration: none;">
					<h3>unzip(unzipPath, overwrite)</h3>
				</a>
				<p>Returns <code>Promise&lt;boolean&gt;</code> with:</p>
				<ul>
					<li>If result is <code>true</code>, unzip is successful or has already been unzipped.</li>
				</ul>
				<p>Or throw exception.</p>
				<a href="#unzippath-string" id="unzippath-string" style="color: inherit; text-decoration: none;">
					<h4>unzipPath: <code>string</code></h4>
				</a>
				<a href="#overwrite-boolean" id="overwrite-boolean" style="color: inherit; text-decoration: none;">
					<h4>overwrite: <code>boolean</code></h4>
				</a>
				<hr>
				<a href="#onprogress--callbackstep-totalstep-action" id="onprogress--callbackstep-totalstep-action" style="color: inherit; text-decoration: none;">
					<h3>onProgress = callback(step, totalStep, action)</h3>
				</a>
				<p>Tells the progress of parser through <code>callback</code>.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Action } = ComicParser; <span class="hljs-comment">// PARSE, READ_ITEMS</span>
parser.onProgress = <span class="hljs-function">(<span class="hljs-params">step, totalStep, action</span>) =&gt;</span> {
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`[<span class="hljs-subst">${action}</span>] <span class="hljs-subst">${step}</span> / <span class="hljs-subst">${totalStep}</span>`</span>);
}</code></pre>
				<a href="#model" id="model" style="color: inherit; text-decoration: none;">
					<h2>Model</h2>
				</a>
				<p><a id="book"></a></p>
				<a href="#comicbook" id="comicbook" style="color: inherit; text-decoration: none;">
					<h3><a href="./src/model/Book.js">ComicBook</a></h3>
				</a>
				<ul>
					<li>items: <em><a href="#item">Item</a>[]</em></li>
					<li>toRaw(): <em>object</em></li>
				</ul>
				<p><a id="item"></a></p>
				<a href="#item" id="item" style="color: inherit; text-decoration: none;">
					<h3><a href="./src/model/Item.js">Item</a></h3>
				</a>
				<ul>
					<li>index: <em>?string</em></li>
					<li>path: <em>?string</em></li>
					<li>size: <em>?number</em></li>
					<li>width: <em>?number</em></li>
					<li>height: <em>?number</em></li>
					<li>toRaw(): <em>object</em></li>
				</ul>
				<p><a id="parseOptions"></a></p>
				<a href="#parse-options" id="parse-options" style="color: inherit; text-decoration: none;">
					<h2>Parse Options</h2>
				</a>
				<ul>
					<li><a href="#unzipPath">unzipPath</a></li>
					<li><a href="#overwrite">overwrite</a></li>
					<li><a href="#ext">ext</a></li>
					<li><a href="#parseImageSize">parseImageSize</a></li>
				</ul>
				<hr>
				<p><a id="unzipPath"></a></p>
				<a href="#unzippath-string-1" id="unzippath-string-1" style="color: inherit; text-decoration: none;">
					<h3>unzipPath: <em><code>?string</code></em></h3>
				</a>
				<p>If specified, unzip to that path.</p>
				<blockquote>
					<p>only using if input is Zip file.</p>
				</blockquote>
				<p><strong>Default:</strong> <code>undefined</code></p>
				<hr>
				<p><a id="overwrite"></a></p>
				<a href="#overwrite-boolean-1" id="overwrite-boolean-1" style="color: inherit; text-decoration: none;">
					<h3>overwrite: <em><code>boolean</code></em></h3>
				</a>
				<p>If true, overwrite to <a href="#unzipPath">unzipPath</a> when unzip.</p>
				<blockquote>
					<p>only using if unzipPath specified.</p>
				</blockquote>
				<p><strong>Default:</strong> <code>true</code></p>
				<hr>
				<p><a id="ext"></a></p>
				<a href="#ext-string" id="ext-string" style="color: inherit; text-decoration: none;">
					<h3>ext: <em><code>string[]</code></em></h3>
				</a>
				<p>File extension to allow when extracting lists.</p>
				<p><strong>Default:</strong> <code>[&#39;jpg&#39;, &#39;jpeg&#39;, &#39;png&#39;, &#39;bmp&#39;, &#39;gif&#39;]</code></p>
				<hr>
				<p><a id="parseImageSize"></a></p>
				<a href="#parseimagesize-booleannumber" id="parseimagesize-booleannumber" style="color: inherit; text-decoration: none;">
					<h3>parseImageSize: <em><code>boolean|number</code></em></h3>
				</a>
				<p>If true, image size parse. (parse may be slower.)</p>
				<p><strong>Default:</strong> <code>false</code></p>
				<p><a id="readOptions"></a></p>
				<a href="#read-options" id="read-options" style="color: inherit; text-decoration: none;">
					<h2>Read Options</h2>
				</a>
				<ul>
					<li><a href="#force">force</a></li>
					<li><a href="#base64">base64</a></li>
				</ul>
				<hr>
				<p><a id="force"></a></p>
				<a href="#force-boolean" id="force-boolean" style="color: inherit; text-decoration: none;">
					<h3>force: <em>boolean</em></h3>
				</a>
				<p>If true, ignore any exceptions that occur within parser.</p>
				<p><strong>Default:</strong> <code>false</code></p>
				<hr>
				<p><a id="base64"></a></p>
				<a href="#base64-boolean" id="base64-boolean" style="color: inherit; text-decoration: none;">
					<h3>base64: <em><code>boolean</code></em></h3>
				</a>
				<p>If false, reads image into a buffer.</p>
				<p><strong>Default:</strong> <code>false</code></p>
				<a href="#license" id="license" style="color: inherit; text-decoration: none;">
					<h2>License</h2>
				</a>
				<p><a href="https://github.com/ridi/content-parser/packages/comic-parser/LICENSE">MIT</a></p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="globals.html"><em>Globals</em></a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_comicparser_d_.html">&quot;<wbr>Comic<wbr>Parser.d&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_model_comicbook_d_.html">&quot;model/<wbr>Comic<wbr>Book.d&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_model_comicitem_d_.html">&quot;model/<wbr>Comic<wbr>Item.d&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_model_comicparsecontext_d_.html">&quot;model/<wbr>Comic<wbr>Parse<wbr>Context.d&quot;</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/_model_comicreadcontext_d_.html">&quot;model/<wbr>Comic<wbr>Read<wbr>Context.d&quot;</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>